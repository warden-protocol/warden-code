import "dotenv/config";
import { AgentServer } from "@wardenprotocol/agent-kit";
import { handler } from "./agent.js";

const PORT = Number(process.env.PORT) || 3000;
const HOST = process.env.HOST || "localhost";
const BASE_URL = `http://${HOST}:${PORT}`;
const AGENT_URL = process.env.AGENT_URL || BASE_URL;

const server = new AgentServer({
  agentCard: {
    name: "{{name}}",
    description: "{{description}}",
    url: AGENT_URL,
    version: "0.1.0",
    capabilities: {
      streaming: {{capabilities_streaming}},
      multiTurn: {{capabilities_multiturn}},
    },
    skills: [{{skills}}],
  },
  handler,
});

server.listen(PORT).then(() => {
  {{model_startup_log}}
  console.log(`{{name}} (Dual Protocol)`);
  console.log(`Server: ${AGENT_URL}`);
  console.log();
  console.log("A2A Protocol:");
  console.log(`  Agent Card: ${AGENT_URL}/.well-known/agent-card.json`);
  console.log(`  JSON-RPC:   POST ${AGENT_URL}/`);
  console.log();
  console.log("LangGraph Protocol:");
  console.log(`  Info:       ${AGENT_URL}/info`);
  console.log(`  Assistants: ${AGENT_URL}/assistants`);
  console.log(`  Threads:    ${AGENT_URL}/threads`);
  console.log(`  Runs:       ${AGENT_URL}/runs`);
});
